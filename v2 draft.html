<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Australian GP Winners — Visual Analysis</title>
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
  <style>
    body {
      font-family: "Inter", Arial, sans-serif;
      margin: 30px auto;
      max-width: 1200px;
      padding: 0 20px;
      background: #fafafa;
      color: #222;
    }
    h1 {
      font-size: 26px;
      margin-bottom: 5px;
    }
    h2 {
      font-size: 20px;
      margin-top: 40px;
    }
    .chart {
      margin: 30px 0;
      border-radius: 10px;
      background: white;
      padding: 20px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>

  <h1>Australian GP Winners — Data Visualisation Suite (2018–2024)</h1>
  <p>This page explores how Australian Grand Prix winners performed across the season, comparing qualifying efficiency, team relationships, and geographic race outcomes.</p>

  <div class="chart" id="chart1"></div>
  <div class="chart" id="chart2"></div>
  <div class="chart" id="chart3"></div>
  <div class="chart" id="chart4"></div>

  <script type="text/javascript">
    // Chart 1: Winner vs Teammate Progression
    const chart1 = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "title": {
        "text": "Australian GP Winners vs Teammate Performance Across the Season",
        "anchor": "start",
        "fontSize": 16
      },
      "data": {
        "url": "https://raw.githubusercontent.com/ericluo-aot/FIT3179-V2/refs/heads/main/season_points_winners.csv"
      },
      "transform": [
        {"filter": "datum.season >= 2018"},
        {
          "calculate": "datum.role === 'Winner' ? datum.constructorName : datum.constructorName + '_teammate'",
          "as": "lineColorKey"
        }
      ],
      "facet": {
        "field": "facetTitle",
        "type": "ordinal",
        "sort": "ascending",
        "header": {"title": null}
      },
      "spec": {
        "width": 320,
        "height": 200,
        "layer": [
          {
            "mark": {"type": "line", "strokeWidth": 3, "interpolate": "monotone"},
            "encoding": {
              "x": {"field": "round", "type": "quantitative", "title": "Round"},
              "y": {"field": "cumulative_points", "type": "quantitative", "title": "Cumulative Points"},
              "color": {
                "field": "lineColorKey",
                "type": "nominal",
                "scale": {
                  "domain": [
                    "Mercedes", "Mercedes_teammate",
                    "Red Bull", "Red Bull_teammate",
                    "Ferrari", "Ferrari_teammate",
                    "McLaren", "McLaren_teammate"
                  ],
                  "range": [
                    "#00d2be", "#00d2be44",
                    "#1e41ff", "#1e41ff44",
                    "#dc0000", "#dc000044",
                    "#ff8700", "#ff870044"
                  ]
                }
              },
              "tooltip": [
                {"field": "driverName"},
                {"field": "constructorName"},
                {"field": "raceName"},
                {"field": "cumulative_points", "title": "Cumulative Points"}
              ]
            }
          },
          {
            "mark": {"type": "circle", "size": 60},
            "encoding": {
              "x": {"field": "round", "type": "quantitative"},
              "y": {"field": "cumulative_points", "type": "quantitative"},
              "color": {"field": "lineColorKey", "type": "nominal"}
            }
          }
        ]
      },
      "resolve": {"scale": {"y": "shared", "x": "shared"}},
      "config": {"facet": {"spacing": 20}, "legend": {"disable": true}}
    };

    // Chart 2: Qualifying vs Finishing
    const chart2 = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "data": {"url": "https://raw.githubusercontent.com/ericluo-aot/FIT3179-V2/refs/heads/main/season_points_winner_only.csv"},
      "title": "Qualifying vs Finishing Efficiency (Aus GP Winners, 2018+)",
      "transform": [
        {"filter": "datum.season >= 2018"},
        {
          "aggregate": [
            {"op": "mean", "field": "grid", "as": "avgGrid"},
            {"op": "mean", "field": "positionOrder", "as": "avgFinish"},
            {"op": "sum", "field": "points", "as": "totalPoints"}
          ],
          "groupby": ["season", "driverName", "driverImage"]
        }
      ],
      "layer": [
        {
          "mark": {"type": "image", "width": 50, "height": 60},
          "encoding": {
            "x": {"field": "avgGrid", "type": "quantitative", "axis": {"title": "Avg Grid"}},
            "y": {"field": "avgFinish", "type": "quantitative", "scale": {"reverse": true}, "axis": {"title": "Avg Finish"}},
            "url": {"field": "driverImage"}
          }
        }
      ]
    };

    // Chart 3: Map
    const chart3 = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "title": {
        "text": "Where Do Australian GP Winners Travel? (2018–2024)",
        "subtitle": "Countries shaded by average points scored. Dots show race circuits sized by number of races.",
        "anchor": "start"
      },
      "width": 900,
      "height": 550,
      "projection": {"type": "equalEarth"},
      "layer": [
        {
          "data": {
            "url": "https://raw.githubusercontent.com/ericluo-aot/FIT3179-V2/main/countries-50m.json",
            "format": {"type": "topojson", "feature": "countries"}
          },
          "mark": {"type": "geoshape", "fill": "#e0e0e0", "stroke": "white", "strokeWidth": 0.6}
        }
      ]
    };

    // Chart 4: Driver vs Constructor Standing
    const chart4 = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "title": {
        "text": "Australian GP Winners vs Constructor Performance (2018–2024)",
        "subtitle": "Comparing winners’ and constructors’ championship standings"
      },
      "data": {
        "url": "https://raw.githubusercontent.com/ericluo-aot/FIT3179-V2/refs/heads/main/ausgp_driver_vs_team_standing.csv"
      },
      "mark": "bar",
      "encoding": {
        "x": {"field": "season", "type": "ordinal", "title": "Season"},
        "y": {"field": "driverStanding", "type": "quantitative", "title": "Standing"},
        "color": {"field": "constructorName", "type": "nominal"}
      }
    };

    vegaEmbed('#chart1', chart1, {actions: false});
    vegaEmbed('#chart2', chart2, {actions: false});
    vegaEmbed('#chart3', chart3, {actions: false});
    vegaEmbed('#chart4', chart4, {actions: false});
  </script>

</body>
</html>
